/* 
  HEADER STYLING (THE CLEAN DRAWER)
  - Search: Compact (480px), White, Subtle Border
  - Right Icons: DRAWER MODE (Only Avatar + Arrow visible, others expand on hover)
*/

/* 1. MASTER HEADER WRAPPER */
body #gb,
body header {
  background-color: rgba(255, 255, 255, 0.98) !important;
  box-shadow: none !important;
  border-bottom: 1px solid rgba(0, 0, 0, 0.03) !important;
}

/* 2. ULTRA-COMPACT SEARCH BAR */
body form[role='search'] {
  max-width: 480px !important;
  margin-left: auto !important;
  margin-right: auto !important;

  background-color: #ffffff !important;
  border: 1px solid #e0e0e0 !important;
  border-radius: 24px !important;
  box-shadow: none !important;
  transition:
    border-color 0.2s,
    box-shadow 0.2s !important;
}

body form[role='search']:hover,
body form[role='search']:focus-within {
  border-color: #c0c0c0 !important;
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05) !important;
}

/* 3. FILTER ICON (HOVER ONLY) */
body form[role='search'] [aria-label*='options'],
body form[role='search'] [aria-label*='Options'],
body form[role='search'] [aria-label*='Advanced'],
body form[role='search'] [data-tooltip*='options'] {
  opacity: 0 !important;
  transition: opacity 0.2s !important;
}

body form[role='search']:hover [aria-label*='options'],
body form[role='search']:focus-within [aria-label*='options'] {
  opacity: 1 !important;
}

/* 4. SEARCH ICON (ALWAYS VISIBLE) */
body form[role='search'] [aria-label*='Search mail'],
body form[role='search'] [aria-label^='Search'],
body form[role='search'] button:first-of-type {
  opacity: 1 !important;
}

/* 5. RIGHT ICONS DRAWER (MAGIC) */

/* Target the container that holds the Avatar */
/* This is our "Drawer" container */
body div:has(> [aria-label*='Google Account']),
body div:has(> a[aria-label*='Google Account']) {
  display: flex !important;
  align-items: center !important;
  justify-content: flex-end !important;
  gap: 4px !important;
  padding-right: 8px !important;
}

/* Items to HIDE by default (Collapse functionality) */
body div:has(> [aria-label*='Google Account']) [aria-label*='Settings'],
body div:has(> [aria-label*='Google Account']) [aria-label*='Google apps'],
body div:has(> [aria-label*='Google Account']) [aria-label*='Support'] {
  opacity: 0 !important;
  max-width: 0px !important; /* Collapse space */
  padding: 0 !important;
  margin: 0 !important;
  overflow: hidden !important;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1) !important;
  pointer-events: none !important;
}

/* REVEAL on HOVER of the Container */
body div:has(> [aria-label*='Google Account']):hover [aria-label*='Settings'],
body div:has(> [aria-label*='Google Account']):hover [aria-label*='Google apps'],
body div:has(> [aria-label*='Google Account']):hover [aria-label*='Support'] {
  opacity: 1 !important;
  max-width: 40px !important; /* Restore width */
  pointer-events: auto !important;
  margin: 0 4px !important;
}

/* Items to KEEP VISIBLE (Avatar & Side Panel Arrow) */
body [aria-label*="Google Account"],
body [aria-label*="Side panel"],  /* The Arrow */
body [aria-label*="side panel"] {
  opacity: 1 !important;
  z-index: 10 !important;
}
